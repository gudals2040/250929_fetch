<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>fetch</title>
  </head>
  <body>
    <input type="text" id="userId" placeholder="유저 ID 입력" />
    <button id="userIDBtn">검색</button>
    <!-- https://jsonplaceholder.typicode.com/  -->
    <script>
      // Promise -> 원래 흐름과 별도로 외부 네트워크의 종료 여부를 알아서 처리
      const response = fetch("https://jsonplaceholder.typicode.com/users/1");
      console.log(response);
      // promise -> then
      response
        .then((res) => {
          console.log(res.status); // 200
          console.log(res.ok); // 2xx status -> true 나머지 4xx, 5xx.
          // res.text().then(console.log); // 밑줄이랑 같이 못 씀
          // res.json().then(console.log); // JSON String -> 자바 스크립트 객체
          return res.json();
        })
        .then((data) => console.log(data)); // 원한다면 promise 값을 다음으로 return해서 새로운 체이닝의 then으로 받을 수 있음.

      async function fetchUser() {
        const userId = document.querySelector("#userId").value;
        // await -> async
        const response = await fetch(
          // "https://jsonplaceholder.typicode.com/users/1"
          `https://jsonplaceholder.typicode.com/users/${userId}`
        );
        const data = await response.json();
        console.log(data);
        // 여기 이해하기 ★
        // 1. Promise -> then => await. 1번 써준다고 끝나는게 아니라 결곽밧이 Promise면 그때마다....
        // 2. await -> async. async function. (event handler, fetching)
      }
      // fetchUser();  // 어떨 때 호출이 되는가? -> Event. -> Button, Form -> 네트워크 요청
      // Listener -> Callback (Handler 함수) -> async. + await.
      document.querySelector("#userIDBtn").addEventListener("click", fetchUser);
    </script>
  </body>
</html>
